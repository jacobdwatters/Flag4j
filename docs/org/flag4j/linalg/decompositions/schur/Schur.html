<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (16) on Wed Jul 10 19:04:27 MDT 2024 -->
<title>Schur</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2024-07-10">
<meta name="description" content="declaration: package: org.flag4j.linalg.decompositions.schur, class: Schur">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar.top">
<div class="skip-nav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar.top.firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip.navbar.top">
<!--   -->
</span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.flag4j.linalg.decompositions.schur</a></div>
<h1 title="Class Schur" class="title">Class Schur&lt;T extends <a href="../../../core/MatrixMixin.html" title="interface in org.flag4j.core">MatrixMixin</a>&lt;T,&#8203;?,&#8203;?,&#8203;?,&#8203;?,&#8203;?,&#8203;?&gt;,&#8203;U&gt;</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">org.flag4j.linalg.decompositions.schur.Schur&lt;T,&#8203;U&gt;</div>
</div>
<section class="description">
<dl class="notes">
<dt>Type Parameters:</dt>
<dd><code>T</code> - The type of matrix to be decomposed.</dd>
<dd><code>U</code> - The type for the internal storage datastructure of the matrix to be decomposed.</dd>
</dl>
<dl class="notes">
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="../Decomposition.html" title="interface in org.flag4j.linalg.decompositions">Decomposition</a>&lt;T&gt;</code></dd>
</dl>
<dl class="notes">
<dt>Direct Known Subclasses:</dt>
<dd><code><a href="ComplexSchur.html" title="class in org.flag4j.linalg.decompositions.schur">ComplexSchur</a></code>, <code><a href="RealSchur.html" title="class in org.flag4j.linalg.decompositions.schur">RealSchur</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public abstract class </span><span class="element-name type-name-label">Schur&lt;T extends <a href="../../../core/MatrixMixin.html" title="interface in org.flag4j.core">MatrixMixin</a>&lt;T,&#8203;?,&#8203;?,&#8203;?,&#8203;?,&#8203;?,&#8203;?&gt;,&#8203;U&gt;</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>
implements <a href="../Decomposition.html" title="interface in org.flag4j.linalg.decompositions">Decomposition</a>&lt;T&gt;</span></div>
<div class="block"><p>The base class for Schur decompositions.</p>

 <p>The Schur decomposition decompose a square matrix <code>A</code> into <code>A=UTU&lt;sup&gt;H&lt;/sup&gt;</code> where <code>U</code> is a unitary
 matrix and <code>T</code> is a quasi-upper triangular matrix called the Schur form of <code>A</code>. <code>T</code> is upper triangular
 except for possibly 2x2 blocks along the diagonal. <code>T</code> is similar to <code>A</code> meaning they share the same eigenvalues.
 </p></div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field.summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>protected boolean</code></div>
<div class="col-second even-row-color"><code><span class="member-name-link"><a href="#checkFinite">checkFinite</a></span></code></div>
<div class="col-last even-row-color">
<div class="block">Flag indicating if a check should be made during the decomposition that the working matrix contains only finite values.</div>
</div>
<div class="col-first odd-row-color"><code>protected boolean</code></div>
<div class="col-second odd-row-color"><code><span class="member-name-link"><a href="#computeU">computeU</a></span></code></div>
<div class="col-last odd-row-color">
<div class="block">Flag indicating if the orthogonal matrix <code>U</code> in the Schur decomposition should be computed.</div>
</div>
<div class="col-first even-row-color"><code>protected int</code></div>
<div class="col-second even-row-color"><code><span class="member-name-link"><a href="#DEFAULT_EXCEPTIONAL_ITERS">DEFAULT_EXCEPTIONAL_ITERS</a></span></code></div>
<div class="col-last even-row-color">
<div class="block">Default number of iterations to apply before doing an exceptional shift.</div>
</div>
<div class="col-first odd-row-color"><code>protected int</code></div>
<div class="col-second odd-row-color"><code><span class="member-name-link"><a href="#DEFAULT_MAX_ITERS_FACTOR">DEFAULT_MAX_ITERS_FACTOR</a></span></code></div>
<div class="col-last odd-row-color">
<div class="block">Default factor for computing the maximum number of iterations to perform.</div>
</div>
<div class="col-first even-row-color"><code>protected int</code></div>
<div class="col-second even-row-color"><code><span class="member-name-link"><a href="#exceptionalThreshold">exceptionalThreshold</a></span></code></div>
<div class="col-last even-row-color">
<div class="block">Number of iterations to run without deflation before an exceptional shift is done.</div>
</div>
<div class="col-first odd-row-color"><code>protected <a href="../unitary/UnitaryDecomposition.html" title="class in org.flag4j.linalg.decompositions.unitary">UnitaryDecomposition</a>&lt;<a href="Schur.html" title="type parameter in Schur">T</a>,&#8203;<a href="Schur.html" title="type parameter in Schur">U</a>&gt;</code></div>
<div class="col-second odd-row-color"><code><span class="member-name-link"><a href="#hess">hess</a></span></code></div>
<div class="col-last odd-row-color">
<div class="block">Decomposer to compute the Hessenburg decomposition as a setup step for the implicit double step QR algorithm.</div>
</div>
<div class="col-first even-row-color"><code>protected <a href="Schur.html" title="type parameter in Schur">U</a></code></div>
<div class="col-second even-row-color"><code><span class="member-name-link"><a href="#householderVector">householderVector</a></span></code></div>
<div class="col-last even-row-color">
<div class="block">Stores the vector <code>v</code> in the Householder reflector <code>P = I - </code>&alpha<code>vv</code><sup>T</sup>.</div>
</div>
<div class="col-first odd-row-color"><code>protected int</code></div>
<div class="col-second odd-row-color"><code><span class="member-name-link"><a href="#maxIterations">maxIterations</a></span></code></div>
<div class="col-last odd-row-color">
<div class="block">Maximum number of iterations to run QR algorithm for.</div>
</div>
<div class="col-first even-row-color"><code>protected int</code></div>
<div class="col-second even-row-color"><code><span class="member-name-link"><a href="#maxIterationsFactor">maxIterationsFactor</a></span></code></div>
<div class="col-last even-row-color">
<div class="block">Factor for computing the maximum number of iterations to run the <code>QR</code> algorithm for.</div>
</div>
<div class="col-first odd-row-color"><code>protected int</code></div>
<div class="col-second odd-row-color"><code><span class="member-name-link"><a href="#numExceptional">numExceptional</a></span></code></div>
<div class="col-last odd-row-color">
<div class="block">The total number of exceptional shifts that have been used during the decomposition.</div>
</div>
<div class="col-first even-row-color"><code>protected int</code></div>
<div class="col-second even-row-color"><code><span class="member-name-link"><a href="#numRows">numRows</a></span></code></div>
<div class="col-last even-row-color">
<div class="block">Stores the number of rows in the matrix being decomposed.</div>
</div>
<div class="col-first odd-row-color"><code>protected <a href="../../../rng/RandomCNumber.html" title="class in org.flag4j.rng">RandomCNumber</a></code></div>
<div class="col-second odd-row-color"><code><span class="member-name-link"><a href="#rng">rng</a></span></code></div>
<div class="col-last odd-row-color">
<div class="block">Random number generator to be used when computing a random exceptional shift.</div>
</div>
<div class="col-first even-row-color"><code>protected <a href="Schur.html" title="type parameter in Schur">U</a></code></div>
<div class="col-second even-row-color"><code><span class="member-name-link"><a href="#shiftCol">shiftCol</a></span></code></div>
<div class="col-last even-row-color">
<div class="block">Stores the non-zero entries of the first column of the shifted matrix <code>(A-</code>&rho<sub>1</sub><code>I)(A-</code>&rho<sub>2</sub><code>I)</code>
 where
 &rho<sub>1</sub> and &rho<sub>2</sub> are the two shifts.</div>
</div>
<div class="col-first odd-row-color"><code>protected int</code></div>
<div class="col-second odd-row-color"><code><span class="member-name-link"><a href="#sinceLastExceptional">sinceLastExceptional</a></span></code></div>
<div class="col-last odd-row-color">
<div class="block">The number of iterations run in the QR algorithm without deflating or performing an exceptional shift.</div>
</div>
<div class="col-first even-row-color"><code>protected <a href="Schur.html" title="type parameter in Schur">T</a></code></div>
<div class="col-second even-row-color"><code><span class="member-name-link"><a href="#T">T</a></span></code></div>
<div class="col-last even-row-color">
<div class="block">For storing the (possibly block) upper triangular matrix <code>T</code> in the Schur decomposition.</div>
</div>
<div class="col-first odd-row-color"><code>protected <a href="Schur.html" title="type parameter in Schur">U</a></code></div>
<div class="col-second odd-row-color"><code><span class="member-name-link"><a href="#temp">temp</a></span></code></div>
<div class="col-last odd-row-color">
<div class="block">Array for holding temporary values when computing the shifts.</div>
</div>
<div class="col-first even-row-color"><code>protected <a href="Schur.html" title="type parameter in Schur">T</a></code></div>
<div class="col-second even-row-color"><code><span class="member-name-link"><a href="#U">U</a></span></code></div>
<div class="col-last even-row-color">
<div class="block">For storing the unitary <code>U</code> matrix in the Schur decomposition.</div>
</div>
<div class="col-first odd-row-color"><code>protected <a href="Schur.html" title="type parameter in Schur">U</a></code></div>
<div class="col-second odd-row-color"><code><span class="member-name-link"><a href="#workArray">workArray</a></span></code></div>
<div class="col-last odd-row-color">
<div class="block">An array for storing temporary values along the colum of a matrix when applying Householder reflectors.</div>
</div>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor.summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><span class="member-name-link"><a href="#%3Cinit%3E(boolean,org.flag4j.rng.RandomCNumber,org.flag4j.linalg.decompositions.unitary.UnitaryDecomposition)">Schur</a></span>&#8203;(boolean&nbsp;computeU,
 <a href="../../../rng/RandomCNumber.html" title="class in org.flag4j.rng">RandomCNumber</a>&nbsp;rng,
 <a href="../unitary/UnitaryDecomposition.html" title="class in org.flag4j.linalg.decompositions.unitary">UnitaryDecomposition</a>&lt;<a href="Schur.html" title="type parameter in Schur">T</a>,&#8203;<a href="Schur.html" title="type parameter in Schur">U</a>&gt;&nbsp;hess)</code></div>
<div class="col-last even-row-color">
<div class="block">Creates a decomposer to compute the Schur decomposition for a real dense matrix.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method.summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table-tab2 method-summary-table method-summary-table-tab3"><code>protected abstract int</code></div>
<div class="col-second even-row-color method-summary-table-tab2 method-summary-table method-summary-table-tab3"><code><span class="member-name-link"><a href="#checkConvergence(int)">checkConvergence</a></span>&#8203;(int&nbsp;workingSize)</code></div>
<div class="col-last even-row-color method-summary-table-tab2 method-summary-table method-summary-table-tab3">
<div class="block">Checks for convergence of lower 2x2 sub-matrix within working matrix to upper triangular or block upper triangular form.</div>
</div>
<div class="col-first odd-row-color method-summary-table-tab2 method-summary-table-tab4 method-summary-table"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table-tab2 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#decomposeBase(T)">decomposeBase</a></span>&#8203;(<a href="Schur.html" title="type parameter in Schur">T</a>&nbsp;src)</code></div>
<div class="col-last odd-row-color method-summary-table-tab2 method-summary-table-tab4 method-summary-table">
<div class="block">Computes the Schur decomposition of the input matrix.</div>
</div>
<div class="col-first even-row-color method-summary-table-tab2 method-summary-table-tab4 method-summary-table"><code><a href="Schur.html" title="type parameter in Schur">T</a></code></div>
<div class="col-second even-row-color method-summary-table-tab2 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#getT()">getT</a></span>()</code></div>
<div class="col-last even-row-color method-summary-table-tab2 method-summary-table-tab4 method-summary-table">
<div class="block">Gets the upper, or possibly block-upper, triangular Schur matrix <code>T</code> from the Schur decomposition</div>
</div>
<div class="col-first odd-row-color method-summary-table-tab2 method-summary-table-tab4 method-summary-table"><code><a href="Schur.html" title="type parameter in Schur">T</a></code></div>
<div class="col-second odd-row-color method-summary-table-tab2 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#getU()">getU</a></span>()</code></div>
<div class="col-last odd-row-color method-summary-table-tab2 method-summary-table-tab4 method-summary-table">
<div class="block">Gets the unitary matrix <code>U</code> from the Schur decomposition containing the Schur vectors as its columns.</div>
</div>
<div class="col-first even-row-color method-summary-table-tab2 method-summary-table method-summary-table-tab3"><code>protected abstract void</code></div>
<div class="col-second even-row-color method-summary-table-tab2 method-summary-table method-summary-table-tab3"><code><span class="member-name-link"><a href="#performDoubleShift(int)">performDoubleShift</a></span>&#8203;(int&nbsp;workingSize)</code></div>
<div class="col-last even-row-color method-summary-table-tab2 method-summary-table method-summary-table-tab3">
<div class="block">Performs a full iteration of the Francis implicit double shifted <code>QR</code> algorithm (this includes the bulge chase).</div>
</div>
<div class="col-first odd-row-color method-summary-table-tab2 method-summary-table method-summary-table-tab3"><code>protected abstract void</code></div>
<div class="col-second odd-row-color method-summary-table-tab2 method-summary-table method-summary-table-tab3"><code><span class="member-name-link"><a href="#performExceptionalShift(int)">performExceptionalShift</a></span>&#8203;(int&nbsp;workingSize)</code></div>
<div class="col-last odd-row-color method-summary-table-tab2 method-summary-table method-summary-table-tab3">
<div class="block">Performs a full iteration of the single shifted <code>QR</code> algorithm (this includes the bulge chase) where the shift is
 chosen to be a random value with the same magnitude as the lower right element of the working matrix.</div>
</div>
<div class="col-first even-row-color method-summary-table-tab2 method-summary-table-tab4 method-summary-table"><code><a href="Schur.html" title="class in org.flag4j.linalg.decompositions.schur">Schur</a>&lt;<a href="Schur.html" title="type parameter in Schur">T</a>,&#8203;<a href="Schur.html" title="type parameter in Schur">U</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table-tab2 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#setExceptionalThreshold(int)">setExceptionalThreshold</a></span>&#8203;(int&nbsp;exceptionalThreshold)</code></div>
<div class="col-last even-row-color method-summary-table-tab2 method-summary-table-tab4 method-summary-table">
<div class="block">Sets the number of iterations of the <code>QR</code> algorithm to perform without deflation before performing a random shift.</div>
</div>
<div class="col-first odd-row-color method-summary-table-tab2 method-summary-table-tab4 method-summary-table"><code><a href="Schur.html" title="class in org.flag4j.linalg.decompositions.schur">Schur</a>&lt;<a href="Schur.html" title="type parameter in Schur">T</a>,&#8203;<a href="Schur.html" title="type parameter in Schur">U</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table-tab2 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#setMaxIterationFactor(int)">setMaxIterationFactor</a></span>&#8203;(int&nbsp;maxIterationFactor)</code></div>
<div class="col-last odd-row-color method-summary-table-tab2 method-summary-table-tab4 method-summary-table">
<div class="block">Specify maximum iteration factor for computing the total number of iterations to run the <code>QR</code> algorithm
 for when computing the decomposition.</div>
</div>
<div class="col-first even-row-color method-summary-table-tab2 method-summary-table-tab4 method-summary-table"><code>protected void</code></div>
<div class="col-second even-row-color method-summary-table-tab2 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#setUp(T)">setUp</a></span>&#8203;(<a href="Schur.html" title="type parameter in Schur">T</a>&nbsp;src)</code></div>
<div class="col-last even-row-color method-summary-table-tab2 method-summary-table-tab4 method-summary-table">
<div class="block">Performs basic setup and initializes data structures to be used in the decomposition.</div>
</div>
<div class="col-first odd-row-color method-summary-table-tab2 method-summary-table method-summary-table-tab3"><code>protected abstract void</code></div>
<div class="col-second odd-row-color method-summary-table-tab2 method-summary-table method-summary-table-tab3"><code><span class="member-name-link"><a href="#setUpArrays()">setUpArrays</a></span>()</code></div>
<div class="col-last odd-row-color method-summary-table-tab2 method-summary-table method-summary-table-tab3">
<div class="block">Initializes temporary work arrays to be used in the decomposition.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods.inherited.from.class.java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
<div class="inherited-list">
<h3 id="methods.inherited.from.class.org.flag4j.linalg.decompositions.Decomposition">Methods inherited from interface&nbsp;org.flag4j.linalg.decompositions.<a href="../Decomposition.html" title="interface in org.flag4j.linalg.decompositions">Decomposition</a></h3>
<code><a href="../Decomposition.html#decompose(T)">decompose</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field.detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="rng">
<h3>rng</h3>
<div class="member-signature"><span class="modifiers">protected final</span>&nbsp;<span class="return-type"><a href="../../../rng/RandomCNumber.html" title="class in org.flag4j.rng">RandomCNumber</a></span>&nbsp;<span class="element-name">rng</span></div>
<div class="block">Random number generator to be used when computing a random exceptional shift.</div>
</section>
</li>
<li>
<section class="detail" id="DEFAULT_EXCEPTIONAL_ITERS">
<h3>DEFAULT_EXCEPTIONAL_ITERS</h3>
<div class="member-signature"><span class="modifiers">protected final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">DEFAULT_EXCEPTIONAL_ITERS</span></div>
<div class="block">Default number of iterations to apply before doing an exceptional shift.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd><a href="../../../../../constant-values.html#org.flag4j.linalg.decompositions.schur.Schur.DEFAULT_EXCEPTIONAL_ITERS">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="DEFAULT_MAX_ITERS_FACTOR">
<h3>DEFAULT_MAX_ITERS_FACTOR</h3>
<div class="member-signature"><span class="modifiers">protected final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">DEFAULT_MAX_ITERS_FACTOR</span></div>
<div class="block">Default factor for computing the maximum number of iterations to perform.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd><a href="../../../../../constant-values.html#org.flag4j.linalg.decompositions.schur.Schur.DEFAULT_MAX_ITERS_FACTOR">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="T">
<h3>T</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="Schur.html" title="type parameter in Schur">T</a> extends <a href="../../../core/MatrixMixin.html" title="interface in org.flag4j.core">MatrixMixin</a>&lt;<a href="Schur.html" title="type parameter in Schur">T</a>,&#8203;?,&#8203;?,&#8203;?,&#8203;?,&#8203;?,&#8203;?&gt;</span>&nbsp;<span class="element-name">T</span></div>
<div class="block">For storing the (possibly block) upper triangular matrix <code>T</code> in the Schur decomposition.</div>
</section>
</li>
<li>
<section class="detail" id="U">
<h3>U</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="Schur.html" title="type parameter in Schur">T</a> extends <a href="../../../core/MatrixMixin.html" title="interface in org.flag4j.core">MatrixMixin</a>&lt;<a href="Schur.html" title="type parameter in Schur">T</a>,&#8203;?,&#8203;?,&#8203;?,&#8203;?,&#8203;?,&#8203;?&gt;</span>&nbsp;<span class="element-name">U</span></div>
<div class="block">For storing the unitary <code>U</code> matrix in the Schur decomposition.</div>
</section>
</li>
<li>
<section class="detail" id="hess">
<h3>hess</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="../unitary/UnitaryDecomposition.html" title="class in org.flag4j.linalg.decompositions.unitary">UnitaryDecomposition</a>&lt;<a href="Schur.html" title="type parameter in Schur">T</a> extends <a href="../../../core/MatrixMixin.html" title="interface in org.flag4j.core">MatrixMixin</a>&lt;<a href="Schur.html" title="type parameter in Schur">T</a>,&#8203;?,&#8203;?,&#8203;?,&#8203;?,&#8203;?,&#8203;?&gt;,&#8203;<a href="Schur.html" title="type parameter in Schur">U</a>&gt;</span>&nbsp;<span class="element-name">hess</span></div>
<div class="block">Decomposer to compute the Hessenburg decomposition as a setup step for the implicit double step QR algorithm.</div>
</section>
</li>
<li>
<section class="detail" id="numRows">
<h3>numRows</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">numRows</span></div>
<div class="block">Stores the number of rows in the matrix being decomposed.</div>
</section>
</li>
<li>
<section class="detail" id="householderVector">
<h3>householderVector</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="Schur.html" title="type parameter in Schur">U</a></span>&nbsp;<span class="element-name">householderVector</span></div>
<div class="block">Stores the vector <code>v</code> in the Householder reflector <code>P = I - </code>&alpha<code>vv</code><sup>T</sup>.</div>
</section>
</li>
<li>
<section class="detail" id="shiftCol">
<h3>shiftCol</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="Schur.html" title="type parameter in Schur">U</a></span>&nbsp;<span class="element-name">shiftCol</span></div>
<div class="block">Stores the non-zero entries of the first column of the shifted matrix <code>(A-</code>&rho<sub>1</sub><code>I)(A-</code>&rho<sub>2</sub><code>I)</code>
 where
 &rho<sub>1</sub> and &rho<sub>2</sub> are the two shifts.</div>
</section>
</li>
<li>
<section class="detail" id="workArray">
<h3>workArray</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="Schur.html" title="type parameter in Schur">U</a></span>&nbsp;<span class="element-name">workArray</span></div>
<div class="block">An array for storing temporary values along the colum of a matrix when applying Householder reflectors.
 This can help improve cache performance when applying the reflector.</div>
</section>
</li>
<li>
<section class="detail" id="temp">
<h3>temp</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="Schur.html" title="type parameter in Schur">U</a></span>&nbsp;<span class="element-name">temp</span></div>
<div class="block">Array for holding temporary values when computing the shifts.</div>
</section>
</li>
<li>
<section class="detail" id="maxIterationsFactor">
<h3>maxIterationsFactor</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">maxIterationsFactor</span></div>
<div class="block">Factor for computing the maximum number of iterations to run the <code>QR</code> algorithm for.</div>
</section>
</li>
<li>
<section class="detail" id="maxIterations">
<h3>maxIterations</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">maxIterations</span></div>
<div class="block">Maximum number of iterations to run QR algorithm for.</div>
</section>
</li>
<li>
<section class="detail" id="exceptionalThreshold">
<h3>exceptionalThreshold</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">exceptionalThreshold</span></div>
<div class="block">Number of iterations to run without deflation before an exceptional shift is done.</div>
</section>
</li>
<li>
<section class="detail" id="sinceLastExceptional">
<h3>sinceLastExceptional</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">sinceLastExceptional</span></div>
<div class="block">The number of iterations run in the QR algorithm without deflating or performing an exceptional shift.</div>
</section>
</li>
<li>
<section class="detail" id="numExceptional">
<h3>numExceptional</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">numExceptional</span></div>
<div class="block">The total number of exceptional shifts that have been used during the decomposition.</div>
</section>
</li>
<li>
<section class="detail" id="checkFinite">
<h3>checkFinite</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">checkFinite</span></div>
<div class="block">Flag indicating if a check should be made during the decomposition that the working matrix contains only finite values.
 If true, an explicit check will be made and an exception will be thrown if <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Double.html#isFinite(double)" title="class or interface in java.lang" class="external-link"><code>non-finite</code></a> values are
 found. If false, no check will be made and the floating point arithmetic will carry on with <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Double.html#POSITIVE_INFINITY" title="class or interface in java.lang" class="external-link"><code>infinities</code></a>,  <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Double.html#NEGATIVE_INFINITY" title="class or interface in java.lang" class="external-link"><code>negative-infinities</code></a>, and <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Double.html#NaN" title="class or interface in java.lang" class="external-link"><code>NaNs</code></a> present.</div>
</section>
</li>
<li>
<section class="detail" id="computeU">
<h3>computeU</h3>
<div class="member-signature"><span class="modifiers">protected final</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">computeU</span></div>
<div class="block">Flag indicating if the orthogonal matrix <code>U</code> in the Schur decomposition should be computed. If false, <code>U</code> will
 not be computed. This may provide performance improvements for large matrices when <code>U</code> is not required (for instance:
 in eigenvalue computations where eigenvectors are not needed).</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor.detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;(boolean,org.flag4j.rng.RandomCNumber,org.flag4j.linalg.decompositions.unitary.UnitaryDecomposition)">
<h3>Schur</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">Schur</span>&#8203;<span class="parameters">(boolean&nbsp;computeU,
 <a href="../../../rng/RandomCNumber.html" title="class in org.flag4j.rng">RandomCNumber</a>&nbsp;rng,
 <a href="../unitary/UnitaryDecomposition.html" title="class in org.flag4j.linalg.decompositions.unitary">UnitaryDecomposition</a>&lt;<a href="Schur.html" title="type parameter in Schur">T</a>,&#8203;<a href="Schur.html" title="type parameter in Schur">U</a>&gt;&nbsp;hess)</span></div>
<div class="block"><p>Creates a decomposer to compute the Schur decomposition for a real dense matrix.</p>

 <p>If the <code>U</code> matrix is not needed, passing <code>computeU = false</code> may provide a performance improvement.</p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>computeU</code> - Flag indicating if the unitary <code>U</code> matrix should be computed for the Schur decomposition. If true,
 <code>U</code> will be computed. If false, <code>U</code> will not be computed.</dd>
<dd><code>rng</code> - Random number generator to use when performing random exceptional shifts.</dd>
<dd><code>hess</code> - Decomposer to compute the Hessenburg decomposition as a setup step for the <code>QR</code> algorithm.</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method.detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="setExceptionalThreshold(int)">
<h3>setExceptionalThreshold</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Schur.html" title="class in org.flag4j.linalg.decompositions.schur">Schur</a>&lt;<a href="Schur.html" title="type parameter in Schur">T</a>,&#8203;<a href="Schur.html" title="type parameter in Schur">U</a>&gt;</span>&nbsp;<span class="element-name">setExceptionalThreshold</span>&#8203;<span class="parameters">(int&nbsp;exceptionalThreshold)</span></div>
<div class="block"><p>Sets the number of iterations of the <code>QR</code> algorithm to perform without deflation before performing a random shift.</p>

 <p>That is, if <code>exceptionalThreshold = 10</code>, then at most 10 iterations <code>QR</code> algorithm iterations will be performed.
 If, by the 10th iteration, no convergence has been detected which allows for deflation, then a <code>QR</code> algorithm iteration
 will be performed with a random (i.e. exceptional) shift.</p>

 <p>By default, the threshold is set to <a href="#DEFAULT_EXCEPTIONAL_ITERS"><code>DEFAULT_EXCEPTIONAL_ITERS</code></a></p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>exceptionalThreshold</code> - The new exceptional shift threshold. i.e. the number of iterations to perform without deflation
                             before performing an iteration with random shifts.</dd>
<dt>Returns:</dt>
<dd>A reference to this decomposer.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - If <code>exceptionalThreshold</code> is not positive.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setMaxIterationFactor(int)">
<h3>setMaxIterationFactor</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Schur.html" title="class in org.flag4j.linalg.decompositions.schur">Schur</a>&lt;<a href="Schur.html" title="type parameter in Schur">T</a>,&#8203;<a href="Schur.html" title="type parameter in Schur">U</a>&gt;</span>&nbsp;<span class="element-name">setMaxIterationFactor</span>&#8203;<span class="parameters">(int&nbsp;maxIterationFactor)</span></div>
<div class="block"><p>Specify maximum iteration factor for computing the total number of iterations to run the <code>QR</code> algorithm
 for when computing the decomposition. The maximum number of iterations is computed as
 <pre>
     <code>maxIteration = maxIterationFactor * src.numRows;</code> </pre>
 If the algorithm does not converge within this limit, an error will be thrown.</p>

 <p>By default, this is computed as
 <pre>
     <code>maxIterations = </code><a href="#DEFAULT_MAX_ITERS_FACTOR"><code>DEFAULT_MAX_ITERS_FACTOR</code></a><code>* src.numRows;</code></pre>

 where <code>src</code> is the matrix
 being decomposed.</p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>maxIterationFactor</code> - maximum iteration factor for use in computing the total maximum number of iterations to run the
 <code>QR</code> algorithm for.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - If <code>maxIterationFactor</code> is not positive.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getT()">
<h3>getT</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Schur.html" title="type parameter in Schur">T</a></span>&nbsp;<span class="element-name">getT</span>()</div>
<div class="block">Gets the upper, or possibly block-upper, triangular Schur matrix <code>T</code> from the Schur decomposition</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>The T matrix from the Schur decomposition <code>A=UTU</code><sup>H</sup></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getU()">
<h3>getU</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Schur.html" title="type parameter in Schur">T</a></span>&nbsp;<span class="element-name">getU</span>()</div>
<div class="block">Gets the unitary matrix <code>U</code> from the Schur decomposition containing the Schur vectors as its columns.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd><code>A=UTU</code><sup>H</sup></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="decomposeBase(T)">
<h3 id="decomposeBase(org.flag4j.core.MatrixMixin)">decomposeBase</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">decomposeBase</span>&#8203;<span class="parameters">(<a href="Schur.html" title="type parameter in Schur">T</a>&nbsp;src)</span></div>
<div class="block"><p>Computes the Schur decomposition of the input matrix.</p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>src</code> - The source matrix to decompose.</dd>
<dt>Throws:</dt>
<dd><code><a href="../../../util/exceptions/LinearAlgebraException.html" title="class in org.flag4j.util.exceptions">LinearAlgebraException</a></code> - If the decomposition does not converge within the specified number of max iterations. See
 </dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setUp(T)">
<h3 id="setUp(org.flag4j.core.MatrixMixin)">setUp</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">setUp</span>&#8203;<span class="parameters">(<a href="Schur.html" title="type parameter in Schur">T</a>&nbsp;src)</span></div>
<div class="block">Performs basic setup and initializes data structures to be used in the decomposition.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>src</code> - The matrix to be decomposed.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setUpArrays()">
<h3>setUpArrays</h3>
<div class="member-signature"><span class="modifiers">protected abstract</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">setUpArrays</span>()</div>
<div class="block">Initializes temporary work arrays to be used in the decomposition.</div>
</section>
</li>
<li>
<section class="detail" id="performExceptionalShift(int)">
<h3>performExceptionalShift</h3>
<div class="member-signature"><span class="modifiers">protected abstract</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">performExceptionalShift</span>&#8203;<span class="parameters">(int&nbsp;workingSize)</span></div>
<div class="block">Performs a full iteration of the single shifted <code>QR</code> algorithm (this includes the bulge chase) where the shift is
 chosen to be a random value with the same magnitude as the lower right element of the working matrix. This can help the
 <code>QR</code> converge for certain pathological cases where the double shift algorithm oscillates or fails to converge for
 repeated eigenvalues.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>workingSize</code> - The current working size for the decomposition. I.e. all entries below this row have converged to an upper
                   or possible 2x2 block upper triangular form.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="performDoubleShift(int)">
<h3>performDoubleShift</h3>
<div class="member-signature"><span class="modifiers">protected abstract</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">performDoubleShift</span>&#8203;<span class="parameters">(int&nbsp;workingSize)</span></div>
<div class="block">Performs a full iteration of the Francis implicit double shifted <code>QR</code> algorithm (this includes the bulge chase).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>workingSize</code> - The current working size for the decomposition. I.e. all entries below this row have converged to an upper
                   or possible 2x2 block upper triangular form.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="checkConvergence(int)">
<h3>checkConvergence</h3>
<div class="member-signature"><span class="modifiers">protected abstract</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">checkConvergence</span>&#8203;<span class="parameters">(int&nbsp;workingSize)</span></div>
<div class="block">Checks for convergence of lower 2x2 sub-matrix within working matrix to upper triangular or block upper triangular form. If
 convergence is found, this will also zero out the values which have converged to near zero.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>workingSize</code> - Size of current working matrix.</dd>
<dt>Returns:</dt>
<dd>Returns the amount the working matrix size should be deflated. Will be zero if no convergence is detected, one if
 convergence to upper triangular form is detected and two if convergence to block upper triangular form is detected.</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
