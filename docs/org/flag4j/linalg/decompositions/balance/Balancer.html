<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (23) on Sun Jan 26 23:57:13 MST 2025 -->
<title>Balancer</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2025-01-26">
<meta name="description" content="declaration: package: org.flag4j.linalg.decompositions.balance, class: Balancer">
<meta name="generator" content="javadoc/ClassWriter">
<link rel="stylesheet" type="text/css" href="../../../../../resource-files/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../resource-files/stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script-files/script.js"></script>
<script type="text/javascript" src="../../../../../script-files/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-files/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">const pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="nav-content">
<div class="nav-menu-button"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button></div>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../search.html">Search</a></li>
<li><a href="../../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
</div>
<div class="sub-nav">
<div class="nav-content">
<ol class="sub-nav-list">
<li><a href="package-summary.html">org.flag4j.linalg.decompositions.balance</a></li>
<li><a href="Balancer.html" class="current-selection">Balancer</a></li>
</ol>
<div class="nav-list-search">
<input type="text" id="search-input" disabled placeholder="Search" aria-label="Search in documentation" autocomplete="off">
<input type="reset" id="reset-search" disabled value="Reset">
</div>
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="main-grid">
<nav role="navigation" class="toc" aria-label="Table of contents">
<div class="toc-header">Contents&nbsp;
<input type="text" class="filter-input" disabled placeholder="Filter" aria-label="Filter table of contents" autocomplete="off">
<input type="reset" class="reset-filter" disabled value="Reset">
</div>
<button class="hide-sidebar"><span>Hide sidebar&nbsp;</span>&#10094;</button><button class="show-sidebar">&#10095;<span>&nbsp;Show sidebar</span></button>
<ol class="toc-list">
<li><a href="#" tabindex="0">Description</a></li>
<li><a href="#field-summary" tabindex="0">Field Summary</a></li>
<li><a href="#constructor-summary" tabindex="0">Constructor Summary</a></li>
<li><a href="#method-summary" tabindex="0">Method Summary</a></li>
<li><a href="#field-detail" tabindex="0">Field Details</a>
<ol class="toc-list">
<li><a href="#FACTOR" tabindex="0">FACTOR</a></li>
<li><a href="#BASE_SCALE" tabindex="0">BASE_SCALE</a></li>
<li><a href="#SAFE_MIN_1" tabindex="0">SAFE_MIN_1</a></li>
<li><a href="#SAFE_MAX_1" tabindex="0">SAFE_MAX_1</a></li>
<li><a href="#SAFE_MIN_2" tabindex="0">SAFE_MIN_2</a></li>
<li><a href="#SAFE_MAX_2" tabindex="0">SAFE_MAX_2</a></li>
<li><a href="#scalePerm" tabindex="0">scalePerm</a></li>
<li><a href="#balancedMatrix" tabindex="0">balancedMatrix</a></li>
<li><a href="#size" tabindex="0">size</a></li>
<li><a href="#iHigh" tabindex="0">iHigh</a></li>
<li><a href="#iLow" tabindex="0">iLow</a></li>
<li><a href="#doScaling" tabindex="0">doScaling</a></li>
<li><a href="#doPermutations" tabindex="0">doPermutations</a></li>
<li><a href="#inPlace" tabindex="0">inPlace</a></li>
</ol>
</li>
<li><a href="#constructor-detail" tabindex="0">Constructor Details</a>
<ol class="toc-list">
<li><a href="#%3Cinit%3E(boolean,boolean,boolean)" tabindex="0">Balancer(boolean, boolean, boolean)</a></li>
</ol>
</li>
<li><a href="#method-detail" tabindex="0">Method Details</a>
<ol class="toc-list">
<li><a href="#swapRows(int,int,int,int)" tabindex="0">swapRows(int, int, int, int)</a></li>
<li><a href="#swapCols(int,int,int,int)" tabindex="0">swapCols(int, int, int, int)</a></li>
<li><a href="#isZero(int)" tabindex="0">isZero(int)</a></li>
<li><a href="#vectorNorm(int,int,int)" tabindex="0">vectorNorm(int, int, int)</a></li>
<li><a href="#vectorMaxAbs(int,int,int)" tabindex="0">vectorMaxAbs(int, int, int)</a></li>
<li><a href="#vectorScale(double,int,int,int)" tabindex="0">vectorScale(double, int, int, int)</a></li>
<li><a href="#setUp(T)" tabindex="0">setUp(T)</a></li>
<li><a href="#decompose(T)" tabindex="0">decompose(T)</a></li>
<li><a href="#doIterativePermutations()" tabindex="0">doIterativePermutations()</a></li>
<li><a href="#doIterativeScaling()" tabindex="0">doIterativeScaling()</a></li>
<li><a href="#ensureHasBalanced()" tabindex="0">ensureHasBalanced()</a></li>
<li><a href="#getILow()" tabindex="0">getILow()</a></li>
<li><a href="#getIHigh()" tabindex="0">getIHigh()</a></li>
<li><a href="#getB()" tabindex="0">getB()</a></li>
<li><a href="#getBSubMatrix()" tabindex="0">getBSubMatrix()</a></li>
<li><a href="#getScalePerm()" tabindex="0">getScalePerm()</a></li>
<li><a href="#getD(boolean)" tabindex="0">getD(boolean)</a></li>
<li><a href="#getD()" tabindex="0">getD()</a></li>
<li><a href="#getP()" tabindex="0">getP()</a></li>
<li><a href="#getT()" tabindex="0">getT()</a></li>
</ol>
</li>
</ol>
</nav>
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<h1 title="Class Balancer" class="title">Class Balancer&lt;T extends <a href="../../../arrays/backend/MatrixMixin.html" title="interface in org.flag4j.arrays.backend">MatrixMixin</a>&lt;T,<wbr>?,<wbr>?,<wbr>?&gt;&gt;</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">org.flag4j.linalg.decompositions.balance.Balancer&lt;T&gt;</div>
</div>
<section class="class-description" id="class-description">
<div class="horizontal-scroll">
<dl class="notes">
<dt>Type Parameters:</dt>
<dd><code>T</code> - The type of matrix being balanced.</dd>
</dl>
<dl class="notes">
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="../Decomposition.html" title="interface in org.flag4j.linalg.decompositions">Decomposition</a>&lt;T&gt;</code></dd>
</dl>
<dl class="notes">
<dt>Direct Known Subclasses:</dt>
<dd><code><a href="ComplexBalancer.html" title="class in org.flag4j.linalg.decompositions.balance">ComplexBalancer</a></code>, <code><a href="RealBalancer.html" title="class in org.flag4j.linalg.decompositions.balance">RealBalancer</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public abstract class </span><span class="element-name type-name-label">Balancer&lt;T extends <a href="../../../arrays/backend/MatrixMixin.html" title="interface in org.flag4j.arrays.backend">MatrixMixin</a>&lt;T,<wbr>?,<wbr>?,<wbr>?&gt;&gt;</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>
implements <a href="../Decomposition.html" title="interface in org.flag4j.linalg.decompositions">Decomposition</a>&lt;T&gt;</span></div>
<div class="block"><p>Base class for all decompositions which implement matrix balancing. Balancing a matrix involves computing a
 diagonal similarity transformation to "balance" the rows and columns of the matrix. This balancing is achieved
 by attempting to scale the entries of the matrix by similarity transformations such that the 1-norms of corresponding
 rows and columns have the similar 1-norms. Rows and columns may also be permuted during balancing if requested.

 <p>Balancing is often used as a preprocessing step to improve the conditioning of eigenvalue problems. Because the
 balancing transformation is a similarity transformation, the eigenvalues are preserved. Further, when permutations are
 done during balancing it is possible to isolate decoupled eigenvalues.

 <p>The similarity transformation of a square matrix A into the balanced matrix B can be described as:
 <pre>
     B = T<sup>-1</sup> A T
       = D<sup>-1</sup> P<sup>-1</sup> A P D.</pre>
 Solving for A, balancing may be viewed as the following decomposition:
 <pre>
     A = T B T<sup>-1</sup>
       = P D B D<sup>-1</sup> P<sup>-1</sup>.</pre>
 Where P is a permutation matrix, and D is a diagonal scaling matrix.

 <p>When permutations are used during balancing we obtain a specific form. First,
 <pre>
             [ T<sub>1</sub>  X   Y  ]
   P<sup>-1</sup> A P = [  0  B<sub>1</sub>  Z  ]
             [  0  0   T<sub>2</sub> ]</pre>
 Where T<sub>1</sub> and T<sub>2</sub> are upper triangular matrices whose eigenvalues lie along the diagonal. These are also
 eigenvalues of A. Then, if scaling is applied we obtain:
 <pre>
                  [ T<sub>1</sub>     X*D<sub>1</sub>       Y    ]
   D<sup>-1</sup> P<sup>-1</sup> A P D = [  0  D<sub>1</sub><sup>-1</sup>*B*<sub>1</sub>D<sub>1</sub>  D<sub>1</sub><sup>-1</sup>*Z  ]
                  [  0      0         T<sub>2</sub>   ]</pre>
 Where D<sub>1</sub> is a diagonal matrix such that,
 <pre>
         [ I<sub>1</sub> 0  0  ]
     D = [ 0  D<sub>1</sub> 0  ]
         [ 0  0  I<sub>2</sub> ]</pre>
 Where I<sub>1</sub> and I<sub>2</sub> are identity matrices with equivalent shapes to T<sub>1</sub> and T<sub>2</sub>.

 <p>Once balancing has been applied, one need only compute the eigenvalues of B<sub>1</sub> and combine them with the diagonal
 entries of T<sub>1</sub> and T<sub>2</sub> to obtain all eigenvalues of A.

 <p>The code in this class if heavily based on LAPACK's reference implementations of
 <a href=https://www.netlib.org/lapack/explore-html/df/df3/group__gebal.html>xGEBAL</a> (v 3.12.1).</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="#getB()"><code>getB()</code></a></li>
<li><a href="#getBSubMatrix()"><code>getBSubMatrix()</code></a></li>
<li><a href="#getD(boolean)"><code>getD(boolean)</code></a></li>
<li><a href="#getD()"><code>getD()</code></a></li>
<li><a href="#getP()"><code>getP()</code></a></li>
<li><a href="#getT()"><code>getT()</code></a></li>
</ul>
</dd>
</dl>
</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>protected <a href="Balancer.html" title="type parameter in Balancer">T</a></code></div>
<div class="col-second even-row-color"><code><a href="#balancedMatrix" class="member-name-link">balancedMatrix</a></code></div>
<div class="col-last even-row-color">
<div class="block">Stores the balanced matrix.</div>
</div>
<div class="col-first odd-row-color"><code>private static final double</code></div>
<div class="col-second odd-row-color"><code><a href="#BASE_SCALE" class="member-name-link">BASE_SCALE</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>protected boolean</code></div>
<div class="col-second even-row-color"><code><a href="#doPermutations" class="member-name-link">doPermutations</a></code></div>
<div class="col-last even-row-color">
<div class="block">Flag indicating if permutations should be done during balancing.</div>
</div>
<div class="col-first odd-row-color"><code>protected boolean</code></div>
<div class="col-second odd-row-color"><code><a href="#doScaling" class="member-name-link">doScaling</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Flag indicating if scaling should be done during balancing.</div>
</div>
<div class="col-first even-row-color"><code>private static final double</code></div>
<div class="col-second even-row-color"><code><a href="#FACTOR" class="member-name-link">FACTOR</a></code></div>
<div class="col-last even-row-color">
<div class="block">Simple scaling factor used to help ensure safe scaling without over/underflow.</div>
</div>
<div class="col-first odd-row-color"><code>protected int</code></div>
<div class="col-second odd-row-color"><code><a href="#iHigh" class="member-name-link">iHigh</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Tracks the ending row/column index of the un-permuted submatrix to be balanced (exclusive).</div>
</div>
<div class="col-first even-row-color"><code>protected int</code></div>
<div class="col-second even-row-color"><code><a href="#iLow" class="member-name-link">iLow</a></code></div>
<div class="col-last even-row-color">
<div class="block">Tracks the starting row/column index of the un-permuted submatrix to be balanced (inclusive).</div>
</div>
<div class="col-first odd-row-color"><code>final boolean</code></div>
<div class="col-second odd-row-color"><code><a href="#inPlace" class="member-name-link">inPlace</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Flag indicating if the balancing should be done in-place or if a copy should be made.</div>
</div>
<div class="col-first even-row-color"><code>private static final double</code></div>
<div class="col-second even-row-color"><code><a href="#SAFE_MAX_1" class="member-name-link">SAFE_MAX_1</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>private static final double</code></div>
<div class="col-second odd-row-color"><code><a href="#SAFE_MAX_2" class="member-name-link">SAFE_MAX_2</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>private static final double</code></div>
<div class="col-second even-row-color"><code><a href="#SAFE_MIN_1" class="member-name-link">SAFE_MIN_1</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>private static final double</code></div>
<div class="col-second odd-row-color"><code><a href="#SAFE_MIN_2" class="member-name-link">SAFE_MIN_2</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>protected double[]</code></div>
<div class="col-second even-row-color"><code><a href="#scalePerm" class="member-name-link">scalePerm</a></code></div>
<div class="col-last even-row-color">
<div class="block">Stores both the scaling and permutation information for the balanced matrix.</div>
</div>
<div class="col-first odd-row-color"><code>protected int</code></div>
<div class="col-second odd-row-color"><code><a href="#size" class="member-name-link">size</a></code></div>
<div class="col-last odd-row-color">
<div class="block">This size of the matrix to be balanced.</div>
</div>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier</div>
<div class="table-header col-second">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>protected </code></div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(boolean,boolean,boolean)" class="member-name-link">Balancer</a><wbr>(boolean&nbsp;doPermutations,
 boolean&nbsp;doScaling,
 boolean&nbsp;inPlace)</code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Balancer.html" title="class in org.flag4j.linalg.decompositions.balance">Balancer</a><wbr>&lt;<a href="Balancer.html" title="type parameter in Balancer">T</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#decompose(T)" class="member-name-link">decompose</a><wbr>(<a href="Balancer.html" title="type parameter in Balancer">T</a>&nbsp;src)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Balances a matrix so that the rows and columns have roughly similar sized norms.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#doIterativePermutations()" class="member-name-link">doIterativePermutations</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Performs the permutation step of matrix balancing.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#doIterativeScaling()" class="member-name-link">doIterativeScaling</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Performs the scaling step of matrix balancing.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#ensureHasBalanced()" class="member-name-link">ensureHasBalanced</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Ensures that <a href="#decompose(T)"><code>decompose(MatrixMixin)</code></a> has been called on this instance.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Balancer.html" title="type parameter in Balancer">T</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getB()" class="member-name-link">getB</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Gets the full balanced matrix, B, for the last matrix balanced by this balancer.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Balancer.html" title="type parameter in Balancer">T</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getBSubMatrix()" class="member-name-link">getBSubMatrix</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Gets the sub-matrix B<sub>1</sub> of the full balanced matrix which did not isolate eigenvalues.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="../../../arrays/dense/Matrix.html" title="class in org.flag4j.arrays.dense">Matrix</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getD()" class="member-name-link">getD</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Gets the diagonal scaling factors for the last matrix balanced by this balancer.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="../../../arrays/dense/Matrix.html" title="class in org.flag4j.arrays.dense">Matrix</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getD(boolean)" class="member-name-link">getD</a><wbr>(boolean&nbsp;full)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Gets the diagonal scaling matrix for the last matrix balanced by this balancer.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getIHigh()" class="member-name-link">getIHigh</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Gets the starting index (exclusive) for the sub-matrix B<sub>1</sub> of the balanced matrix which did not isolate eigenvalues.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getILow()" class="member-name-link">getILow</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Gets the starting index (inclusive) for the sub-matrix B<sub>1</sub> of the balanced matrix which did not isolate eigenvalues.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="../../../arrays/sparse/PermutationMatrix.html" title="class in org.flag4j.arrays.sparse">PermutationMatrix</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getP()" class="member-name-link">getP</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Gets the permutation matrix for the last matrix balanced by this balancer.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>double[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getScalePerm()" class="member-name-link">getScalePerm</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Gets the raw scaling factors and permutation data stored in a single array.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="../../../arrays/dense/Matrix.html" title="class in org.flag4j.arrays.dense">Matrix</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getT()" class="member-name-link">getT</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Get the combined permutation and diagonal scaling matrix, T, from the last matrix balanced.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>protected abstract boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#isZero(int)" class="member-name-link">isZero</a><wbr>(int&nbsp;idx)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Checks if a value within <a href="#balancedMatrix"><code>balancedMatrix</code></a> is zero.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>private void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setUp(T)" class="member-name-link">setUp</a><wbr>(<a href="Balancer.html" title="type parameter in Balancer">T</a>&nbsp;src)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Performs basic setup for balancing.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>protected abstract void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#swapCols(int,int,int,int)" class="member-name-link">swapCols</a><wbr>(int&nbsp;colIdx1,
 int&nbsp;colIdx2,
 int&nbsp;start,
 int&nbsp;stop)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Swaps two columns, over a specified range, within the <a href="#balancedMatrix"><code>balancedMatrix</code></a> matrix.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>protected abstract void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#swapRows(int,int,int,int)" class="member-name-link">swapRows</a><wbr>(int&nbsp;rowIdx1,
 int&nbsp;rowIdx2,
 int&nbsp;start,
 int&nbsp;stop)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Swaps two rows, over a specified range, within the <a href="#balancedMatrix"><code>balancedMatrix</code></a> matrix.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>protected abstract double</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#vectorMaxAbs(int,int,int)" class="member-name-link">vectorMaxAbs</a><wbr>(int&nbsp;start,
 int&nbsp;n,
 int&nbsp;stride)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Computes the maximum absolute value of a vector with <code>n</code> elements from <a href="#balancedMatrix"><code>balancedMatrix</code></a>'s 1D data array
 starting at index <code>start</code> and spaced by <code>stride</code>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>protected abstract double</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#vectorNorm(int,int,int)" class="member-name-link">vectorNorm</a><wbr>(int&nbsp;start,
 int&nbsp;n,
 int&nbsp;stride)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Computes the &ell;<sup>2</sup> norm of a vector with <code>n</code> elements from <a href="#balancedMatrix"><code>balancedMatrix</code></a>'s 1D data array
 starting at index <code>start</code> and spaced by <code>stride</code>.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>protected abstract void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#vectorScale(double,int,int,int)" class="member-name-link">vectorScale</a><wbr>(double&nbsp;factor,
 int&nbsp;start,
 int&nbsp;n,
 int&nbsp;stride)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Scales a vector with <code>n</code> elements from <a href="#balancedMatrix"><code>balancedMatrix</code></a>'s 1D data array
 starting at index <code>start</code> and spaced by <code>stride</code>.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field-detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="FACTOR">
<h3>FACTOR</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">FACTOR</span></div>
<div class="block">Simple scaling factor used to help ensure safe scaling without over/underflow.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="../../../../../constant-values.html#org.flag4j.linalg.decompositions.balance.Balancer.FACTOR">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="BASE_SCALE">
<h3>BASE_SCALE</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">BASE_SCALE</span></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="../../../../../constant-values.html#org.flag4j.linalg.decompositions.balance.Balancer.BASE_SCALE">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="SAFE_MIN_1">
<h3>SAFE_MIN_1</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">SAFE_MIN_1</span></div>
</div>
</section>
</li>
<li>
<section class="detail" id="SAFE_MAX_1">
<h3>SAFE_MAX_1</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">SAFE_MAX_1</span></div>
</div>
</section>
</li>
<li>
<section class="detail" id="SAFE_MIN_2">
<h3>SAFE_MIN_2</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">SAFE_MIN_2</span></div>
</div>
</section>
</li>
<li>
<section class="detail" id="SAFE_MAX_2">
<h3>SAFE_MAX_2</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">SAFE_MAX_2</span></div>
</div>
</section>
</li>
<li>
<section class="detail" id="scalePerm">
<h3>scalePerm</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">double[]</span>&nbsp;<span class="element-name">scalePerm</span></div>
<div class="block"><p>Stores both the scaling and permutation information for the balanced matrix.

 <p>Let <code>perm[j]</code> be the index of the row and column swapped with row and column <code>j</code> and
 <code>scale[j]</code> be the scaling factor applied to row and column <code>j</code>. Then,
 <ul>
     <li><code>scalePerm[j] = perm[j]</code> for <code>j = 0, ..., iLow-1</code>.</li>
     <li><code>scalePerm[j] = scale[j]</code> for <code>j = iLow, ..., iHigh-1</code>.</li>
     <li><code>scalePerm[j] = perm[j]</code> for <code>j = iHigh, ..., size-1</code>.</li>
 </ul>

 The order which row and column swaps are made is <code>size-1</code> to <code>iHigh</code>, then from <code>0</code> to <code>iLow</code>.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="balancedMatrix">
<h3>balancedMatrix</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="Balancer.html" title="type parameter in Balancer">T</a> extends <a href="../../../arrays/backend/MatrixMixin.html" title="interface in org.flag4j.arrays.backend">MatrixMixin</a>&lt;<a href="Balancer.html" title="type parameter in Balancer">T</a>,<wbr>?,<wbr>?,<wbr>?&gt;</span>&nbsp;<span class="element-name">balancedMatrix</span></div>
<div class="block">Stores the balanced matrix.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="size">
<h3>size</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">size</span></div>
<div class="block">This size of the matrix to be balanced.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="iHigh">
<h3>iHigh</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">iHigh</span></div>
<div class="block">Tracks the ending row/column index of the un-permuted submatrix to be balanced (exclusive).</div>
</div>
</section>
</li>
<li>
<section class="detail" id="iLow">
<h3>iLow</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">iLow</span></div>
<div class="block">Tracks the starting row/column index of the un-permuted submatrix to be balanced (inclusive).</div>
</div>
</section>
</li>
<li>
<section class="detail" id="doScaling">
<h3>doScaling</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">doScaling</span></div>
<div class="block">Flag indicating if scaling should be done during balancing.
 <ul>
     <li>If <code>true</code>, then scaling will be performed during balancing.</li>
     <li>If <code>false</code>, the no scaling will be done during balancing.</li>
 </ul></div>
</div>
</section>
</li>
<li>
<section class="detail" id="doPermutations">
<h3>doPermutations</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">doPermutations</span></div>
<div class="block">Flag indicating if permutations should be done during balancing.
 <ul>
     <li>If <code>true</code>: Then row/column permutations will be performed during balancing.</li>
     <li>If <code>false</code>: Then row/column permutations will be performed during balancing.</li>
 </ul></div>
</div>
</section>
</li>
<li>
<section class="detail" id="inPlace">
<h3>inPlace</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public final</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">inPlace</span></div>
<div class="block">Flag indicating if the balancing should be done in-place or if a copy should be made.
 <ul>
     <li>If <code>true</code>, the balancing will be done in-place and the matrix to be balanced will be overwritten.</li>
     <li>If <code>false</code>, a copy will be made of the matrix before balancing is applied and the original matrix will remain
     unmodified.</li>
 </ul></div>
</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;(boolean,boolean,boolean)">
<h3>Balancer</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="element-name">Balancer</span><wbr><span class="parameters">(boolean&nbsp;doPermutations,
 boolean&nbsp;doScaling,
 boolean&nbsp;inPlace)</span></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>doPermutations</code> - Flag indicating if row/column permutations should be used when balancing the matrix.
 <ul>
     <li>If <code>true</code>, permutations will be used and P will be computed.</li>
     <li>If <code>false</code>, permutations will <i>not</i> be used and the row and column positions will not be affected.</li>
 </ul></dd>
<dd><code>doScaling</code> - Flag indicating if row/column scaling should be done when balancing the matrix.
 <ul>
     <li>If <code>true</code>, scaling will be used and D will be computed.</li>
     <li>If <code>false</code>, scaling will <i>not</i> be used.</li>
 </ul></dd>
<dd><code>inPlace</code> - Flag indicating if the balancing should be done in-place or if a copy should be made.
 <ul>
     <li>If <code>true</code>, the balancing will be done in-place and the matrix to be balanced will be overwritten.</li>
     <li>If <code>false</code>, a copy will be made of the matrix before balancing is applied and the original matrix will remain
     unmodified.</li>
 </ul></dd>
</dl>
</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="swapRows(int,int,int,int)">
<h3>swapRows</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected abstract</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">swapRows</span><wbr><span class="parameters">(int&nbsp;rowIdx1,
 int&nbsp;rowIdx2,
 int&nbsp;start,
 int&nbsp;stop)</span></div>
<div class="block">Swaps two rows, over a specified range, within the <a href="#balancedMatrix"><code>balancedMatrix</code></a> matrix.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>rowIdx1</code> - Index of the first row to swap.</dd>
<dd><code>rowIdx2</code> - Index of the second row to swap.</dd>
<dd><code>start</code> - Index of the column specifying the start of the range for the row swap (inclusive).</dd>
<dd><code>stop</code> - Index of the column specifying the end of the range for the row swap (exclusive).</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="swapCols(int,int,int,int)">
<h3>swapCols</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected abstract</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">swapCols</span><wbr><span class="parameters">(int&nbsp;colIdx1,
 int&nbsp;colIdx2,
 int&nbsp;start,
 int&nbsp;stop)</span></div>
<div class="block">Swaps two columns, over a specified range, within the <a href="#balancedMatrix"><code>balancedMatrix</code></a> matrix.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>colIdx1</code> - Index of the first column to swap.</dd>
<dd><code>colIdx2</code> - Index of the second column to swap.</dd>
<dd><code>start</code> - Index of the row specifying the start of the range for the column swap (inclusive).</dd>
<dd><code>stop</code> - Index of the row specifying the end of the range for the column swap (exclusive).</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="isZero(int)">
<h3>isZero</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected abstract</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">isZero</span><wbr><span class="parameters">(int&nbsp;idx)</span></div>
<div class="block">Checks if a value within <a href="#balancedMatrix"><code>balancedMatrix</code></a> is zero.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>idx</code> - Index of value within <a href="#balancedMatrix"><code>balancedMatrix</code></a>'s 1D data array to check if it is zero.</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="vectorNorm(int,int,int)">
<h3>vectorNorm</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected abstract</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">vectorNorm</span><wbr><span class="parameters">(int&nbsp;start,
 int&nbsp;n,
 int&nbsp;stride)</span></div>
<div class="block">Computes the &ell;<sup>2</sup> norm of a vector with <code>n</code> elements from <a href="#balancedMatrix"><code>balancedMatrix</code></a>'s 1D data array
 starting at index <code>start</code> and spaced by <code>stride</code>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>start</code> - Starting index within <a href="#balancedMatrix"><code>balancedMatrix</code></a>'s 1D data array to compute norm of.</dd>
<dd><code>n</code> - The number of elements in the vector to compute norm of.</dd>
<dd><code>stride</code> - The spacing between each element within <a href="#balancedMatrix"><code>balancedMatrix</code></a>'s 1D data array to norm of.</dd>
<dt>Returns:</dt>
<dd>The norm of the vector containing the specified elements from <a href="#balancedMatrix"><code>balancedMatrix</code></a>'s 1D data array.</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="vectorMaxAbs(int,int,int)">
<h3>vectorMaxAbs</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected abstract</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">vectorMaxAbs</span><wbr><span class="parameters">(int&nbsp;start,
 int&nbsp;n,
 int&nbsp;stride)</span></div>
<div class="block">Computes the maximum absolute value of a vector with <code>n</code> elements from <a href="#balancedMatrix"><code>balancedMatrix</code></a>'s 1D data array
 starting at index <code>start</code> and spaced by <code>stride</code>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>start</code> - Starting index within <a href="#balancedMatrix"><code>balancedMatrix</code></a>'s 1D data array to compute maximum absolute value of.</dd>
<dd><code>n</code> - The number of elements in the vector to compute maximum absolute value of.</dd>
<dd><code>stride</code> - The spacing between each element within <a href="#balancedMatrix"><code>balancedMatrix</code></a>'s 1D data array to compute maximum absolute
 value of.</dd>
<dt>Returns:</dt>
<dd>The maximum absolute value of the vector containing the specified elements from <a href="#balancedMatrix"><code>balancedMatrix</code></a>'s 1D data
 array.</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="vectorScale(double,int,int,int)">
<h3>vectorScale</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected abstract</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">vectorScale</span><wbr><span class="parameters">(double&nbsp;factor,
 int&nbsp;start,
 int&nbsp;n,
 int&nbsp;stride)</span></div>
<div class="block">Scales a vector with <code>n</code> elements from <a href="#balancedMatrix"><code>balancedMatrix</code></a>'s 1D data array
 starting at index <code>start</code> and spaced by <code>stride</code>. This operation must be done in-place.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>factor</code> - Factor to scale elements by.</dd>
<dd><code>start</code> - Starting index within <a href="#balancedMatrix"><code>balancedMatrix</code></a>'s 1D data array begin scaling.</dd>
<dd><code>n</code> - The number of elements to scale.</dd>
<dd><code>stride</code> - The spacing between each element within <a href="#balancedMatrix"><code>balancedMatrix</code></a>'s 1D data array to scale.</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="setUp(T)">
<h3 id="setUp(org.flag4j.arrays.backend.MatrixMixin)">setUp</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">setUp</span><wbr><span class="parameters">(<a href="Balancer.html" title="type parameter in Balancer">T</a>&nbsp;src)</span></div>
<div class="block"><p>Performs basic setup for balancing.
 <p>Specifically, copies the matrix to be balanced if an out-of-place computation was requested, initializes the matrix size,
 <a href="#iLow"><code>iLow</code></a>, <a href="#iHigh"><code>iHigh</code></a>, and <a href="#scalePerm"><code>scalePerm</code></a>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>src</code> - The matrix to balance.</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="decompose(T)">
<h3 id="decompose(org.flag4j.arrays.backend.MatrixMixin)">decompose</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Balancer.html" title="class in org.flag4j.linalg.decompositions.balance">Balancer</a>&lt;<a href="Balancer.html" title="type parameter in Balancer">T</a>&gt;</span>&nbsp;<span class="element-name">decompose</span><wbr><span class="parameters">(<a href="Balancer.html" title="type parameter in Balancer">T</a>&nbsp;src)</span></div>
<div class="block">Balances a matrix so that the rows and columns have roughly similar sized norms.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../Decomposition.html#decompose(T)">decompose</a></code>&nbsp;in interface&nbsp;<code><a href="../Decomposition.html" title="interface in org.flag4j.linalg.decompositions">Decomposition</a>&lt;<a href="Balancer.html" title="type parameter in Balancer">T</a> extends <a href="../../../arrays/backend/MatrixMixin.html" title="interface in org.flag4j.arrays.backend">MatrixMixin</a>&lt;<a href="Balancer.html" title="type parameter in Balancer">T</a>,<wbr>?,<wbr>?,<wbr>?&gt;&gt;</code></dd>
<dt>Parameters:</dt>
<dd><code>src</code> - Matrix to balance. Must be square. If <a href="#inPlace"><code>== true</code></a> then <code>src</code> will be modified.
 Otherwise, <code>src</code> will <i>not</i> be modified.</dd>
<dt>Returns:</dt>
<dd>A reference to this balancer object.</dd>
<dt>Throws:</dt>
<dd><code><a href="../../../util/exceptions/TensorShapeException.html" title="class in org.flag4j.util.exceptions">TensorShapeException</a></code> - If <code>src</code> is not a square matrix.</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="doIterativePermutations()">
<h3>doIterativePermutations</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">doIterativePermutations</span>()</div>
<div class="block"><p>Performs the permutation step of matrix balancing.

 <p>This is, identifies rows and columns which are decoupled from the rest of the matrix and hence isolate an
 eigenvalue. Rows which isolate an eigenvalue are pushed to the bottom of the matrix. Similarly, columns which isolate an
 eigenvalue are pushed to the left of the matrix. To ensure that the row/column swaps are similarity transforms, if any two
 rows are swapped the same columns are swapped.

 <p>Such row and column permutations transform the original matrix <code>A</code> into the following form:
 <pre>
             [ T1  X  Y  ]
   P<sup>-1</sup> A P = [  0  B  Z  ]
             [  0  0  T2 ]</pre>
 <p>Where <code>T1</code> and <code>T2</code> are upper-triangular matrices whose eigenvalues are the diagonal elements of the matrix.
 <code>P</code> is the permutation matrix representing the row and column swaps performed within this method.

 <p><a href="#iLow"><code>iLow</code></a> and <a href="#iHigh"><code>iHigh</code></a> Specify the starting (inclusive) and ending (exclusive) row/column index of the submatrix
 <code>B</code>.</div>
</div>
</section>
</li>
<li>
<section class="detail" id="doIterativeScaling()">
<h3>doIterativeScaling</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">doIterativeScaling</span>()</div>
<div class="block"><p>Performs the scaling step of matrix balancing.

 <p>That is, computes scaling factors such that when a column is scaled by such value and the row is scaled by the reciprocal
 of that value, there &ell;<sup>1</sup> norms are "close". Scaling need only be done for rows/column of the matrix which do not
 isolate eigenvalues; rows between <a href="#iLow"><code>iLow</code></a> (inclusive) to <a href="#iHigh"><code>iHigh</code></a> (exclusive).

 <p>D<sub>1</sub> is the diagonal matrix describing such scaling and is the diagonal matrix computed by this method. \
 The diagonal values of D<sub>1</sub> are stored in <a href="#scalePerm"><code>scalePerm</code></a> between indices <a href="#iLow"><code>iLow</code></a> (inclusive) to
 <a href="#iHigh"><code>iHigh</code></a> (exclusive).</div>
</div>
</section>
</li>
<li>
<section class="detail" id="ensureHasBalanced()">
<h3>ensureHasBalanced</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">private</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">ensureHasBalanced</span>()</div>
<div class="block">Ensures that <a href="#decompose(T)"><code>decompose(MatrixMixin)</code></a> has been called on this instance.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - If <a href="#decompose(T)"><code>decompose(MatrixMixin)</code></a> has not been called on this instance.</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="getILow()">
<h3>getILow</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">getILow</span>()</div>
<div class="block">Gets the starting index (inclusive) for the sub-matrix B<sub>1</sub> of the balanced matrix which did not isolate eigenvalues.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>The starting index (inclusive) for the sub-matrix of the balanced matrix which did not isolate eigenvalues.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - If <a href="#decompose(T)"><code>decompose(MatrixMixin)</code></a> has not yet been called on this instance.</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="getIHigh()">
<h3>getIHigh</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">getIHigh</span>()</div>
<div class="block">Gets the starting index (exclusive) for the sub-matrix B<sub>1</sub> of the balanced matrix which did not isolate eigenvalues.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>The starting index (exclusive) for the sub-matrix of the balanced matrix which did not isolate eigenvalues.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - If <a href="#decompose(T)"><code>decompose(MatrixMixin)</code></a> has not yet been called on this instance.</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="getB()">
<h3>getB</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Balancer.html" title="type parameter in Balancer">T</a></span>&nbsp;<span class="element-name">getB</span>()</div>
<div class="block">Gets the full balanced matrix, B, for the last matrix balanced by this balancer.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>The full balanced matrix for the last matrix balanced by this balancer.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - If <a href="#decompose(T)"><code>decompose(MatrixMixin)</code></a> has not yet been called on this instance.</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="getBSubMatrix()">
<h3>getBSubMatrix</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Balancer.html" title="type parameter in Balancer">T</a></span>&nbsp;<span class="element-name">getBSubMatrix</span>()</div>
<div class="block">Gets the sub-matrix B<sub>1</sub> of the full balanced matrix which did not isolate eigenvalues.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>The sub-matrix of the full balanced matrix which did not isolate eigenvalues.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - If <a href="#decompose(T)"><code>decompose(MatrixMixin)</code></a> has not yet been called on this instance.</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="getScalePerm()">
<h3>getScalePerm</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">double[]</span>&nbsp;<span class="element-name">getScalePerm</span>()</div>
<div class="block"><p>Gets the raw scaling factors and permutation data stored in a single array.

 <p>Let <code>perm[j]</code> be the index of the row and column swapped with row and column <code>j</code> and
 <code>scale[j]</code> be the scaling factor applied to row and column <code>j</code>. Then,
 <ul>
     <li><code>scalePerm[j] = perm[j]</code> for <code>j = 0, ..., iLow-1</code>.</li>
     <li><code>scalePerm[j] = scale[j]</code> for <code>j = iLow, ..., iHigh-1</code>.</li>
     <li><code>scalePerm[j] = perm[j]</code> for <code>j = iHigh, ..., size-1</code>.</li>
 </ul>

 The order which row and column swaps are made is <code>size-1</code> to <code>iHigh</code>, then from <code>0</code> to <code>iLow</code>.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>The raw scaling factors and permutation data stored in a single array.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - If <a href="#decompose(T)"><code>decompose(MatrixMixin)</code></a> has not yet been called on this instance.</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="getD(boolean)">
<h3>getD</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="../../../arrays/dense/Matrix.html" title="class in org.flag4j.arrays.dense">Matrix</a></span>&nbsp;<span class="element-name">getD</span><wbr><span class="parameters">(boolean&nbsp;full)</span></div>
<div class="block">Gets the diagonal scaling matrix for the last matrix balanced by this balancer.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>full</code> - Flag indicating if the full diagonal scaling matrix should be constructed or if only the scaling factors should
 be returned. If the last matrix balanced had shape n-by-n then,
 <ul>
     <li>If <code>true</code>: The full n-by-n diagonal scaling matrix will be created.</li>
     <li>If <code>false</code>: A matrix of shape 1-by-n containing only the scaling factors
     (i.e. the diagonal entries of the full scaling matrix).
     </li>
 </ul></dd>
<dt>Returns:</dt>
<dd>If <code>full == true</code> then the full n-by-n scaling matrix is returned. Otherwise if <code>full == false</code>
 a matrix of shape 1-by-n containing only the diagonal scaling factors is returned.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - If <a href="#decompose(T)"><code>decompose(MatrixMixin)</code></a> has not yet been called on this instance.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="#getD()"><code>getD()</code></a></li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="getD()">
<h3>getD</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="../../../arrays/dense/Matrix.html" title="class in org.flag4j.arrays.dense">Matrix</a></span>&nbsp;<span class="element-name">getD</span>()</div>
<div class="block"><p>Gets the diagonal scaling factors for the last matrix balanced by this balancer.

 <p> Note, this method will <i>not</i> construct the full diagonal scaling matrix. If the full matrix is desired, use
 <a href="#getD(boolean)"><code>getD(boolean)</code></a>.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>A 1-by-n matrix containing the diagonal elements of the full n-by-n diagonal scaling matrix.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - If <a href="#decompose(T)"><code>decompose(MatrixMixin)</code></a> has not yet been called on this instance.</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="#getD(boolean)"><code>getD(boolean)</code></a></li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="getP()">
<h3>getP</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="../../../arrays/sparse/PermutationMatrix.html" title="class in org.flag4j.arrays.sparse">PermutationMatrix</a></span>&nbsp;<span class="element-name">getP</span>()</div>
<div class="block"><p>Gets the permutation matrix for the last matrix balanced by this balancer.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>The permutation matrix for the last matrix balanced by this balancer.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - If <a href="#decompose(T)"><code>decompose(MatrixMixin)</code></a> has not yet been called on this instance.</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="getT()">
<h3>getT</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="../../../arrays/dense/Matrix.html" title="class in org.flag4j.arrays.dense">Matrix</a></span>&nbsp;<span class="element-name">getT</span>()</div>
<div class="block">Get the combined permutation and diagonal scaling matrix, T, from the last matrix balanced.
 This is equivalent to <code>getP().leftMult(getD(true))</code>.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>The combined permutation and diagonal scaling matrix from the last matrix balanced.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/23/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - If <a href="#decompose(T)"><code>decompose(MatrixMixin)</code></a> has not yet been called on this instance.</dd>
</dl>
</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</body>
</html>
